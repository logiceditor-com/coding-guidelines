Javascript coding guidelines
============================

Code conventions
================
Принятый стиль основан на Lua code conventions и довольно сильно отличается от принятых в Javascript мире. Приоритеты:

* вызовы browser.sleep вызывают сомнение.
* необходимы более подробные имена тестам. it("schematics") несколько расплывчато. вероятно, имелось в виду it("schematics-open-by-name"), не забываем, что в имени функции желателен глагол
* желательно, чтобы текст внутри it() был в формате "<does something>". т.е., чтобы получалось "it does something", если читать подряд. "it schematics" не читается, "it opens schematics" --- уже лучше (но тогда возникает вопрос, кто такой it --- на него должно отвечать имя сюиты, указанное в describe. То есть, условно, "describe Project Schematics Page", "it can open schematics file", "it can delete existing schematics" etc. etc.
* код тестов должен быть в тестах (т.е. spec/), вне тестов должны быть модели.
* it должен жить в том же файле, что его describe. Допускается в некоторых случаях выносить общий код куда-то ещё, но тогда имя вынесенной функции, вероятно, тоже должно содержать it
* необходимы к каждому тесту проверки, без промежуточных проверок отлаживаться несколько затруднительно.


По поводу wait-ов
------
Реаллизовать цепочку промисов (promise).

```javascript
Screen.prototype = {
 authorize: function(login, password) {
   return this.login.sendKeys(login).then(function() {
     return this.password.sendKeys(password).then(function() {
       return this.enter.click();
     }.bind(this));
   }.bind(this));
 }
};
```

Clear и sendKeys прячем в модель
------
Неправильная запись:

```javascript
	link.page.worktask.clear();
	link.page.worktask.sendKeys(schematics.title);
	link.page.title.clear();
	link.page.title.sendKeys(schematics.title);
	link.page.number.clear();
	link.page.number.sendKeys(schematics.number);
	link.page.revision.clear();
	link.page.revision.sendKeys(schematics.revision);
	link.page.submit.click();
```

Правильная запись:

```javascript
	page
	 .setWorktask(schematics.title)
	 .setTitle(schematics.title) // Два раза title у тебя --- так и задумано?
	 .setNumber(schematics.number)
	 .setRevision(schematics.revision)
	 .submit();
```


Rule of thumb
------------------
если один it() выходит за (условные) 15 строк, его желательно отрефакторить, идея в том, чтобы it-ы не были чрезмерно длинные


Код тестов должен быть:
------------------

* на каждый экран тестируемого приложения должен быть заведён отдельный класс, "модель" этого экрана, для сложных экранов модель может быть составной (например, условно, панель инструментов можно описать в отдельной модели от основной модели экрана)
* в этом классе должны быть описаны те элементы этого экрана, которые необходимы для выполения тех тестов, которые мы пишем сейчас (т.е. все элементы описывать сразу не обязательно)
* описание элементов должно быть сделано таким образом, чтобы минимизировать рутинную копипасту в тестах
* в классе "модели" также можно описывать относящиеся к ней функции, которые облегчают тестирование и минимизируют копипасту в тестах (см. Screen.authorize в моём примере выше)
* эти функции в общем случае не должны содержать вызов it, но должны быть предназначены к использованию внутри него таким образом, чтобы делать код it, где они используются кратким и понятным.
* код тестов, использующий модель, должен быть в файлах в папке spec/
* не допускается включение файла из папки spec/ любым другим файлом в проекте (кроме того, что необходимо для запуска тестов в этом файле). т.е. в файлах spec/ --- конечный код, не библиотечные модули
* не желательна копипаста между файлами в папке spec/ (и файлами проекта вообще)
* утилитарный код, который не относится к моделям, но используется в нескольких spec/ выносится в папку util/, если такого кода много, это может быть признаком того, что пришло время рефакторить архитектуру тестов


